<?xml version="1.0" ?>


<!-- Minimal solrconfig.xml with /select, /admin and /update only -->

<config>
    <dataDir>${solr.data.dir:}</dataDir>

    <directoryFactory name="DirectoryFactory"
                      class="${solr.directoryFactory:solr.NRTCachingDirectoryFactory}"/>
    <schemaFactory class="ClassicIndexSchemaFactory"/>

    <luceneMatchVersion>7.7.2</luceneMatchVersion>

    <updateHandler class="solr.DirectUpdateHandler2">
        <commitWithin>
            <softCommit>${solr.commitwithin.softcommit:true}</softCommit>
        </commitWithin>

    </updateHandler>

    <!-- The default handler should be specified this way, however to support
    the legacy qt=querqy parameter we need to change to what's below.
    <requestHandler name="/select" class="solr.SearchHandler">
    -->
    <requestHandler name="search" class="solr.SearchHandler" default="true">
        <lst name="defaults">
            <str name="echoParams">explicit</str>
            <str name="indent">true</str>
            <str name="df">id</str>
            <str name="qf">name title product_type short_description ean search_attributes</str>
            <str name="defType">edismax</str>
            <str name="tie">0.01</str>
        </lst>
<!--        <lst name="appends">-->
<!--            <str name="fq">price:*</str>-->
<!--            <str name="fq">-img_500x500:""</str>-->
<!--        </lst>-->
    </requestHandler>

    <!-- for the purposes of understanding the impact of "light switch", we want to have
    a mm=100% version.   Today, this is done via change to the front end GUI and changing
    the requestHandler.  In the future, this should be a paramSet that lives in ZK and no
    hardcoding of the front end!  Just a useParams=mustmatchall
    -->
    <!-- &qt=mustmatchall -->
    <requestHandler name="mustmatchall" class="solr.SearchHandler">
        <lst name="defaults">
            <str name="echoParams">explicit</str>
            <str name="indent">true</str>
            <!-- we actually don't want to use the default field -->
            <str name="df">id</str>
            <str name="qf">name title product_type short_description ean search_attributes</str>

            <str name="defType">edismax</str>
            <str name="tie">0.01</str>
            <str name="mm">100&#37;</str>
        </lst>
        <lst name="appends">
            <str name="fq">price:*</str>
            <str name="fq">-img_500x500:""</str>
        </lst>
    </requestHandler>

    <!-- &qt=querqy -->
    <requestHandler name="querqy" class="solr.SearchHandler">
        <lst name="defaults">
            <str name="echoParams">explicit</str>
            <str name="indent">true</str>

            <!-- we actually don't want to use the default field -->
            <str name="df">id</str>
            <str name="qf">name title product_type short_description ean search_attributes</str>

            <str name="defType">querqy</str>

            <str name="tie">0.01</str>
            <str name="mm">100&#37;</str>
        </lst>
        <lst name="appends">
            <str name="fq">price:*</str>
            <str name="fq">-img_500x500:""</str>
        </lst>
    </requestHandler>

    <!-- This is required to support the legacy behavior of the parameter qt=/query-select -->
    <requestDispatcher handleSelect="true" >
        <requestParsers enableRemoteStreaming="false" multipartUploadLimitInKB="512000" />
    </requestDispatcher>

    <queryResponseWriter name="json" class="solr.JSONResponseWriter">
        <str name="content-type">text/javascript; charset=UTF-8</str>
    </queryResponseWriter>


</config>